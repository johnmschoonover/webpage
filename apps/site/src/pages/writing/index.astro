---
import BaseLayout from '@layouts/BaseLayout.astro';
import Card from '@components/Card.astro';
import Tag from '@components/Tag.astro';
import { getCollection } from 'astro:content';
const posts = (await getCollection('posts')).sort((a, b) => (a.data.date > b.data.date ? -1 : 1));
const tags = Array.from(new Set(posts.flatMap((post) => post.data.tags)));
---
<BaseLayout pageHeading="Writing" description="Notes on platform leadership, security engineering, and analytics.">
  <div class="space-y-4">
    <h2 class="font-display text-xl font-semibold">Topics</h2>
    <div class="flex flex-wrap gap-2">
      {tags.map((tag) => (
        <Tag label={tag} />
      ))}
    </div>
  </div>
  <div class="grid gap-6 md:grid-cols-2">
    {posts.map((post) => (
      <Card
        eyebrow={new Date(post.data.date).toLocaleDateString(undefined, { month: 'short', day: 'numeric', year: 'numeric' })}
        title={post.data.title}
        description={post.data.summary}
        href={`/writing/${post.slug}/`}
        cta="Read"
      />
    ))}
  </div>
</BaseLayout>
