---
import BaseLayout from '@layouts/BaseLayout.astro';
import deliverables from '@content/data/deliverables.json';

type Deliverable = {
  title: string;
  status: string;
  summary: string;
  highlights?: string[];
  year?: string;
  url?: string;
};

const entries = (deliverables.items as Deliverable[]).map((entry) => ({
  ...entry,
  highlights: entry.highlights ?? []
}));
---
<BaseLayout
  pageHeading="Deliverables"
  description="Patents, in-flight IP, and key engineering projects."
>
  <div class="space-y-6">
    {entries.map((item) => (
      <article class="rounded-3xl border border-border bg-background/80 p-6">
        <div class="flex items-center justify-between">
          <span class="text-xs uppercase tracking-[0.2em] text-muted-foreground">{item.status}</span>
          {item.year && <span class="text-xs text-muted-foreground">{item.year}</span>}
        </div>
        <h2 class="mt-2 font-display text-xl font-semibold">
          {item.url ? (
            <a href={item.url} target="_blank" rel="noopener noreferrer" class="hover:underline hover:text-primary transition-colors">
              {item.title}
            </a>
          ) : (
            item.title
          )}
        </h2>
        <p class="mt-3 text-sm text-muted-foreground">{item.summary}</p>
        {item.highlights.length > 0 && (
          <ul class="mt-4 space-y-2 text-sm text-muted-foreground">
            {item.highlights.map((highlight) => (
              <li class="flex items-start gap-2">
                <span aria-hidden class="mt-1 inline-block h-1.5 w-1.5 rounded-full bg-primary"></span>
                <span>{highlight}</span>
              </li>
            ))}
          </ul>
        )}
      </article>
    ))}
  </div>
</BaseLayout>
